machine:
  node:
    version: 0.10.40
  pre:
    - curl https://install.meteor.com | /bin/sh

general:
  artifacts:
    - "log"

dependencies:
  override:
    - npm install velocity-cli -g
    - (cd app; meteor list)

test:
  override:
    # Run tests
    - (cd app; velocity test-app --ci)
    # Publish code coverage data to CodeClimate. $CODECLIMATE_REPO_TOKEN is an environment variable setup in CircleCI.
    # Disabled until we get tests reporting to lcov again
    # - npm install -g codeclimate-test-reporter@0.1.1
    # - (cd src/webapp; CODECLIMATE_REPO_TOKEN=$CODECLIMATE_REPO_TOKEN codeclimate-test-reporter < log/coverage/report-lcov/lcov.info)
